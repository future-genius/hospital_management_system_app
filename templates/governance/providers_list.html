{% extends "base.html" %}

{% block title %}Manage Doctors - Clinical Facility Network{% endblock %}

{% block content %}
<div class="container py-4">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="h3 fw-bold text-navy mb-1">Doctor Directory</h1>
      <p class="text-muted mb-0">Manage all physicians in your healthcare facility</p>
    </div>
    <a href="{{ url_for('governance.create_provider') }}" class="btn btn-primary d-flex align-items-center gap-2">
      <i class="fas fa-user-plus"></i> Add New Doctor
    </a>
  </div>

  {% if providers %}
  <div class="card shadow-sm">
    <div class="card-header">
      <i class="fas fa-user-md me-2"></i> Registered Doctors
    </div>
    <div class="card-body p-0">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Department</th>
            <th>Specialization</th>
            <th>Doctor ID</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for provider in providers %}
          <tr>
            <td>
              <div class="d-flex align-items-center gap-2">
                <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center fw-bold" style="width: 36px; height: 36px;">
                  {{ provider.account_link.given_name[0] }}{{ provider.account_link.surname[0] }}
                </div>
                <span class="fw-semibold text-gray-900">{{ provider.account_link.full_name }}</span>
              </div>
            </td>
            <td class="text-gray-700">{{ provider.account_link.email_address }}</td>
            <td>
              <span class="badge bg-primary">{{ provider.clinic_link.clinic_title if provider.clinic_link else 'N/A' }}</span>
            </td>
            <td class="text-gray-700">{{ provider.expertise or 'General Practice' }}</td>
            <td>
              <span class="badge bg-info">{{ provider.doctor_unique_id or 'N/A' }}</span>
            </td>
            <td class="text-center">
              <a href="{{ url_for('governance.edit_provider', provider_id=provider.provider_id) }}" class="btn btn-sm btn-outline-primary" title="Edit">
                <i class="fas fa-edit me-1"></i> Edit
              </a>
              <form method="POST" action="{{ url_for('governance.delete_provider', provider_id=provider.provider_id) }}" style="display: inline;" 
                    onsubmit="return confirm('Delete {{ provider.account_link.full_name }}? This cannot be undone.');">
                <button type="submit" class="btn btn-sm btn-outline-danger" title="Delete">
                  <i class="fas fa-trash me-1"></i> Delete
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% else %}
  <div class="text-center py-5" style="border: 2px dashed rgba(0,0,0,0.1); border-radius: 0.5rem;">
    <div class="mb-3" style="font-size: 3rem; color: var(--primary-main);">
      <i class="fas fa-user-md"></i>
    </div>
    <p class="h6 fw-semibold mb-1">No doctors registered yet</p>
    <p class="text-muted mb-3">Add your first doctor to get started managing your medical staff</p>
    <a href="{{ url_for('governance.create_provider') }}" class="btn btn-primary d-inline-flex align-items-center gap-2">
      <i class="fas fa-user-plus"></i> Register First Doctor
    </a>
  </div>
  {% endif %}

</div>
{% endblock %}
