# Hospital Management System — Project Report

Generated: 2025-11-30

## Executive Summary

This repository implements a Flask-based Hospital Management System supporting role-based workflows for administrators, providers (doctors), and patients (recipients). The application offers user authentication, provider and patient registration, clinic management, appointment scheduling, and administrative management. The project uses SQLite with SQLAlchemy ORM and server-rendered Jinja2 templates.

Recent updates include:
- Unique doctor IDs generated by department.
- Unique patient IDs generated from appointment date + department.
- Admin edit and delete functionality for doctors.
- Safe schema migration scripts to bring the database in sync with models.


## Features by Role

- Admin
  - Dashboard with counts and recent sessions.
  - Manage providers: list, create, edit, delete.
  - Manage patients: list, create, assign department.
  - Manage clinics: list, create.
  - Manage sessions (appointments): list, create, delete.
  - Initial setup and migration scripts included.

- Provider (Doctor)
  - Providers have profiles linked to `Account` and `Clinic`.
  - Time slots and availability management (in `provision` blueprint).

- Patient (Recipient)
  - Patient registration and appointment booking.
  - Appointment history and session views.


## Architecture & Structure

- `app.py` — Application configuration, blueprint registration, and runner.
- `models.py` — SQLAlchemy models: `AccessLevel`, `Account`, `Clinic`, `Provider`, `Recipient`, `TimeSlot`, `Session`, `ClinicalNote`.
- `routes/` — Flask blueprints:
  - `governance.py` — Admin routes.
  - `provision.py` — Provider-facing routes.
  - `clientele.py` — Patient-facing routes.
  - `identity.py` — Authentication.
- `templates/` — Jinja2 templates for each area (admin, provider, patient, authentication).
- `static/` — CSS assets.
- `instance/app.db` — SQLite database.
- `scripts/` — Utility scripts for safe migrations and DB checks.


## Data Model (Summary)

- `access_level` — (tier_id PK, tier_name, tier_description)
- `account` — (account_id PK, email_address, credential_hash, given_name, surname, tier_id FK, is_enabled, created_on)
- `clinic` — (clinic_id PK, clinic_title, clinic_notes)
- `provider` — (provider_id PK FK->account, clinic_id FK->clinic, expertise, biography, doctor_unique_id)
- `recipient` — (recipient_id PK FK->account, clinic_id FK->clinic, patient_unique_id, appointment_date)
- `time_slot` — (slot_id PK, provider_id FK->provider, starts_at, duration_mins, slot_available)
- `session` — (session_id PK, recipient_id FK->recipient, provider_id FK->provider, unique_appointment_code, booked_timestamp, slot_id FK->time_slot, session_state)
- `clinical_note` — (note_id PK, session_id FK->session, recipient_id, provider_id, findings, treatment_plan, noted_on)


## Unique ID Generation

- Providers (doctors): `doctor_unique_id` — Format: `DEPT-NNN` where `DEPT` is derived from clinic title initials and `NNN` is a per-department sequence. Assigned on provider creation.
- Patients (recipients): `patient_unique_id` — Format: `DEPT-DDMMYY-NNN` where `DDMMYY` is the appointment date and `NNN` is the sequence number for that clinic on that date. Assigned at booking time when appointment date is known.


## Important Routes & Templates

- `governance` blueprint (admin)
  - `/governance/hub` → `templates/governance/dashboard.html`
  - `/governance/providers` → `templates/governance/providers_list.html`
  - `/governance/providers/create` → `templates/governance/provider_form.html`
  - `/governance/providers/<id>/edit` → `templates/governance/provider_edit.html`
  - `/governance/providers/<id>/delete` (POST)
  - `/governance/patients/new` → `templates/governance/patient_form.html`
  - `/governance/clinics` → `templates/governance/clinics_list.html`
  - `/governance/sessions` → `templates/governance/sessions_list.html`
  - `/governance/sessions/create` → `templates/governance/session_form.html`

- Provider blueprint (`provision`) — availability, slots, clinical forms.
- Patient blueprint (`clientele`) — booking, browse clinics, sessions.
- Identity blueprint (`identity`) — signin/signup/profile.


## File Structure (current)

Below is a snapshot of the repository file structure generated from the workspace:

```
__init__.py
wsgi.py
README_IMPLEMENTATION.md
QUICK_REFERENCE.md
models.py
migrate_db.py
requirements.txt
init_db.py
TESTING_CHECKLIST.md
IMPLEMENTATION_SUMMARY.md
IMPLEMENTATION_STATUS.md
config.py
CODE_CHANGES.md
app.py
static/
  theme.css
  style.css
instance/
  signup_debug.log
  app.db
templates/
  _sidebar.html
  _header.html
  register.html
  patient_register.html
  patient_dashboard.html
  login.html
  landing.html
  index.html
  doctor_register.html
  doctor_dashboard.html
  base.html
  admin_dashboard.html
  governance/
    session_form.html
    sessions_list.html
    recipients_list.html
    provider_form.html
    provider_edit.html
    providers_list.html
    patient_form.html
    dashboard.html
    clinic_form.html
    clinics_list.html
  doctor/
    patients.html
    dashboard.html
    availability.html
    appointments.html
  provision/
    sessions.html
    recipient_history.html
    dashboard.html
    clinical_form.html
    availability.html
    add_slot_form.html
  patient/
    dashboard.html
    book_appointment.html
    appointments.html
  clientele/
    treatment_history.html
    sessions.html
    search_providers.html
    provider_detail.html
    dashboard.html
    browse_clinics.html
    book_form.html
  authentication/
    signup.html
    signin.html
    profile_view.html
  admin/
    manage_patients.html
    manage_doctors.html
    manage_appointments.html
routes/
  __init__.py
  provision.py
  identity.py
  governance.py
  clientele.py
scripts/
  check_dbs.py
  add_id_columns.py
  add_column.py
templates/authentication/hash_passwords.py
templates/governance/provider_edit.html
templates/governance/providers_list.html
templates/admin/dashboard.html

(NOTE: the list above is a condensed snapshot; see the repo for full paths)
```


## Setup & Run (concise)

1. Create and activate a virtual environment.
2. Install dependencies:

```powershell
python -m pip install -r requirements.txt
```

3. Initialize DB and seed data (non-destructive):

```powershell
python init_db.py
```

4. If you need to repair schema columns added after DB creation: run the scripts in `scripts/`:

```powershell
python scripts/check_dbs.py
python scripts/add_column.py
python scripts/add_id_columns.py
```

5. Run the dev server:

```powershell
python app.py
```


## Convert this report to PDF (optional)

If you have `pandoc` installed you can convert `REPORT.md` to PDF from PowerShell:

```powershell
pandoc REPORT.md -o REPORT.pdf --pdf-engine=xelatex
```

If you do not have Pandoc, you can print the Markdown from a viewer to PDF or install Pandoc: https://pandoc.org/


## Recommendations & Next Steps

- Standardize the database path in `app.py` to `sqlite:///instance/app.db` to avoid confusion.
- Add CSRF protection (Flask-WTF) to forms.
- Add Alembic for database migrations.
- Add automated tests (unit + integration) around booking, ID generation, and admin operations.
- Consider PostgreSQL for production deployments.


---

If you want, I can also:
- Produce `REPORT.pdf` automatically (if you have `pandoc`/LaTeX available here), or
- Save a separate `REPORT.txt` or `REPORT.docx`, or
- Add this report to a `docs/` folder and link it from `README.md`.

Tell me which of those you'd like next.
